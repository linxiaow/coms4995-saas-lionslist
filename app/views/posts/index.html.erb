<!--  This file is app/views/posts/index.html.erb -->
<h2>All Posts</h2> <%= @current_user_id %>
<% unless logged_in?%>
  <br><br>
  <%= link_to "Log In with Google", '/auth/google_oauth2', method: :get %>
<br>
<% end %>

<% unless !logged_in?%>
  <br>
  <%= link_to "Profile", '/profile' %>
  <br>
  <%= link_to "Log out", '/logout', method: :delete %>
<% end %>


<%= form_tag posts_path, method: :get, :class => 'form' do %>
  <%= label_tag(:sort_by, "Sort By") %>
  <%= select_tag(:sort_by, options_for_select([['most recent', 'created date'], ['title', 'title'], ['category', 'category'], ['author', 'author']], @sort_by)) %>
  <%= submit_tag("Sort") %>
<% end %>

<%#  Part 2: Start here... %>

<table class="table table-striped col-md-12" id="movies">
  <thead>
    <tr>
      <th>Post Title</th>
      <th>Category</th>
      <th>Author</th>     
      <th>Created Date</th>
      <th>Last Updated</th>

      <th>More Info</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <% @posts.each do |post| %>
      <tr>
        <td>
          <%= post.title %>
        </td>
        <td>
          <%= post.category %>
        </td>
        <td>
          <%= post.author %>
        </td>
        <td>
          <%= post.created_at %>
        </td>
        <td>
          <%= post.updated_at %>
        </td>
        
        <td>
          <%= link_to "More about #{post.title}", post_path(post) %>
        </td>
        <td>
          <%= button_to "Request Deal", add_deal_path(post), :class => 'btn btn-primary', :method =>:post %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= link_to "Add new post", new_post_path, :class => 'btn btn-primary' %>
